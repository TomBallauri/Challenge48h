<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test de Vitesse de Frappe</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        #timer { position: absolute; top: 10px; right: 10px; font-size: 18px; font-weight: bold; }
        #phrase { font-size: 18px; margin: 20px; width: 80%; margin-left: auto; margin-right: auto; text-align: justify; }
        #input { font-size: 16px; width: 80%; padding: 10px; }
        button { font-size: 16px; margin: 10px; padding: 10px; cursor: pointer; }
        #smallMessage { font-size: 8px; position: absolute; bottom: 5px; right: 5px; color: #d7d7d7d5; display: none; }
        #nextButton { display: none; font-size: 16px; padding: 10px; margin: 10px; cursor: pointer; }
        #validateButton { display: none; font-size: 16px; padding: 10px; margin: 10px; cursor: pointer; }
        #scoreboard { display: none; margin-top: 20px; padding: 10px; border: 1px solid #000; width: 50%; margin-left: auto; margin-right: auto; background-color: #f9f9f9; }
        #lostMessage { display: none; color: red; font-size: 20px; font-weight: bold; margin-top: 20px; }
    </style>
</head>
<body>
    <div id="timer">Temps: 200.00s</div>
    <h1>Test de Vitesse de Frappe</h1>
    <p id="phrase">Cliquez sur "Commencer" pour débuter</p>
    <input type="text" id="input" placeholder="Tapez ici..." disabled>
    <br>
    <button id="startButton" onclick="startGame()">Commencer</button>
    <button id="validateButton" onclick="checkTyping()">Valider</button>
    <div id="scoreboard">
        <h2>Meilleurs Scores</h2>
        <p><span id="score1">0.00</span> sec</p>
        <p><span id="score2">0.00</span> sec</p>
        <p><span id="score3">0.00</span> sec</p>
    </div>
    <p id="smallMessage">Il faut entrer le mot "Porte".</p>
    <button id="nextButton" onclick="goToNextPage()">Suivant</button>
    <p id="lostMessage">Temps écoulé ! Vous avez perdu.</p>

    <script>
        const phrase = "Dans un monde lointain, où les montagnes touchaient presque le ciel et les forêts semblaient cacher des secrets anciens, un voyageur solitaire se lança dans une aventure périlleuse. Chaque étape le rapprochait des mystères cachés, et chaque nouveau chemin semblait mener à un horizon inconnu. Les nuits étaient froides et les jours pleins de découvertes surprenantes, mais il avançait sans relâche, guidé par une vision qui ne cessait de grandir. C'était un défi, mais il savait qu'au bout de ce voyage, un trésor inestimable l'attendait. À la fin de son périple, il avait enfin trouvé ce qu'il cherchait, regardez en bas a droite de l'écran, mais il ne pouvait s'empêcher de penser aux leçons apprises sur le chemin.";
        const correctWord = "Porte";
        let startTime, timerInterval;
        let highScores = [Infinity, Infinity, Infinity];

        function startGame() {
            document.getElementById("phrase").innerText = phrase;
            document.getElementById("input").value = "";
            document.getElementById("input").disabled = false;
            document.getElementById("input").focus();
            document.getElementById("startButton").style.display = "none";
            document.getElementById("smallMessage").style.display = "block";
            document.getElementById("validateButton").style.display = "inline-block";
            document.getElementById("scoreboard").style.display = "none";
            document.getElementById("lostMessage").style.display = "none";

            startTime = new Date().getTime();
            let timeLeft = 200;
            document.getElementById("timer").innerText = `Temps: ${timeLeft.toFixed(2)}s`;
            
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                const elapsedTime = (new Date().getTime() - startTime) / 1000;
                timeLeft = 200 - elapsedTime;
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    document.getElementById("input").disabled = true;
                    document.getElementById("lostMessage").style.display = "block";
                } else {
                    document.getElementById("timer").innerText = `Temps: ${timeLeft.toFixed(2)}s`;
                }
            }, 100);
        }

        function checkTyping() {
            clearInterval(timerInterval);
            const endTime = new Date().getTime();
            const userInput = document.getElementById("input").value;

            if (userInput === correctWord) {
                const elapsedTime = (endTime - startTime) / 1000;
                updateHighScores(elapsedTime);
                document.getElementById("nextButton").style.display = "inline-block";
            }
        }

        function updateHighScores(newScore) {
            highScores.push(newScore);
            highScores.sort((a, b) => a - b);
            highScores = highScores.slice(0, 3);

            document.getElementById("score1").innerText = highScores[0] !== Infinity ? highScores[0].toFixed(2) : "0.00";
            document.getElementById("score2").innerText = highScores[1] !== Infinity ? highScores[1].toFixed(2) : "0.00";
            document.getElementById("score3").innerText = highScores[2] !== Infinity ? highScores[2].toFixed(2) : "0.00";

            document.getElementById("scoreboard").style.display = "block";
        }

        document.getElementById("input").addEventListener("keydown", function(event) {
            if (event.key === "Enter") {
                checkTyping();
            }
        });

        function goToNextPage() {
            window.location.href = "Snake.html";
        }
    </script>
</body>
</html>